<template>
    <div class="discover">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
           style="position:absolute;width:0;height:0">
        <defs>
          <symbol style="fill:#f94843;" viewBox="-4 3 30 30" id="alarm">
            <g id="alarm_页面">
              <g id="alarm_发现页_新增天天特价_确认" transform="translate(-31 -1587)">
                <g id="alarm_商品" transform="translate(-2 1556)">
                  <g id="alarm_Page-1">
                    <path
                      d="M10 29.9c-7.2 0-13-5.8-13-13 0-2 .4-3.9 1.3-5.7C.5 6.7 5 3.9 10 3.9c7.2 0 13 5.8 13 13s-5.8 13-13 13zM.1 12.1C-.7 13.6-1 15.2-1 16.9c0 6.1 4.9 11 11 11s11-4.9 11-11-4.9-11-11-11c-4.3 0-8.1 2.3-9.9 6.2z"
                      class="st0" transform="translate(34 32)"></path>
                    <path
                      d="M-1 12.1c-1.8-.9-3-2.7-3-4.8C-4 4.4-1.6 2 1.3 2c2 0 3.8 1.1 4.7 2.8l-1.8 1C3.7 4.7 2.5 4 1.3 4-.5 4-2 5.5-2 7.3c0 1.3.7 2.4 1.8 3l-.8 1.8zM21 11.8l-1-1.7c1-.6 1.6-1.7 1.6-2.8 0-1.8-1.5-3.3-3.3-3.3-1.3 0-2.5.8-3.1 2l-1.8-.8c.8-2 2.8-3.3 4.9-3.3 2.9 0 5.3 2.4 5.3 5.3-.1 2-1 3.7-2.6 4.6zM14.3 20.2h-4.2c-.6 0-1-.4-1-1v-8.1c0-.6.4-1 1-1s1 .4 1 1v7.1h3.2c.6 0 1 .4 1 1s-.4 1-1 1zM-1.2 32c-.2 0-.5-.1-.7-.3-.4-.4-.4-1-.1-1.4l4-4.5c.4-.4 1-.4 1.4-.1.4.4.4 1 .1 1.4l-4 4.5c-.2.3-.4.4-.7.4zM21.5 32c-.3 0-.5-.1-.7-.3l-4-4.5c-.4-.4-.3-1 .1-1.4.4-.4 1-.3 1.4.1l4 4.5c.4.4.3 1-.1 1.4-.2.1-.4.2-.7.2z"
                      class="st0" transform="translate(34 32)"></path>
                  </g>
                </g>
              </g>
            </g>
          </symbol>
          <symbol style="fill:#ff6000" viewBox="0 0 35 35" id="tag">
            <g id="tag_页面">
              <g id="tag_发现页_新增天天特价_确认" transform="translate(-267 -513)">
                <g id="tag_天天特价" transform="translate(-1 471)">
                  <g id="tag_天天" transform="translate(1)">
                    <g id="tag_title" transform="translate(221 39)">
                      <g id="tag_Group-4">
                        <g id="tag_Group-5" transform="translate(47)">
                          <g id="tag_tag">
                            <path
                              d="M12.6 33.4c-.3 0-.5-.1-.7-.3L-.7 20.4c-.4-.4-.4-1 0-1.4L18.8-.7c.2-.2.5-.3.7-.3h12.9c.6 0 1 .4 1 1v12.3c0 .3-.1.5-.3.7L13.3 33c-.1.2-.4.3-.7.4zM1.4 19.7l11.2 11.2 18.8-19V1H20L1.4 19.7z"
                              class="st0" transform="translate(0 4)"></path>
                            <path
                              d="M24.8 10.9c-2.1 0-3.7-1.7-3.7-3.7s1.7-3.7 3.7-3.7 3.7 1.7 3.7 3.7-1.7 3.7-3.7 3.7zm0-5.5c-1 0-1.7.8-1.7 1.7 0 1 .8 1.7 1.7 1.7 1 0 1.7-.8 1.7-1.7 0-.9-.8-1.7-1.7-1.7zM6.9 21.9c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l9.7-9.7c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4l-9.7 9.7c-.2.2-.5.3-.7.3zM10.3 25.3c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l6.5-6.5c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4L11 25c-.2.2-.5.3-.7.3z"
                              class="st0" transform="translate(0 4)"></path>
                          </g>
                        </g>
                      </g>
                    </g>
                  </g>
                </g>
              </g>
            </g>
          </symbol>
          <symbol viewBox="0 0 16 25" id="tab_found_next_page">
            <path fill="none" fill-rule="evenodd" stroke="#CCC" stroke-linecap="round" stroke-width="3"
                  d="M2.127 2l10.87 10.582L2.291 23.11"></path>
          </symbol>
          <symbol viewBox="0 0 34 33" id="nice">
            <g fill="#F12C2C" fill-rule="evenodd">
              <path
                d="M19.1 10s.404-1.959.685-3.294l.068-.323a472.237 472.237 0 0 1 .83-3.832l.077-.352C21.016 1.036 20.194 0 19.01 0H14.49c-.625 0-1.284.377-1.606.915l-5.742 9.57L8 10H2.003A1.995 1.995 0 0 0 0 11.999V31C0 32.106.9 33 2.003 33h23c1.548 0 3.082-1.157 3.507-2.645l4.63-16.204C33.776 11.923 32.32 10 30 10H19.1zM18 12h12c.993 0 1.488.653 1.217 1.601l-4.63 16.205c-.18.629-.929 1.194-1.584 1.194h-23L2 11.999C2 11.996 8 12 8 12h.566l.291-.486 5.743-9.57c-.037.061-.028.056-.109.056h4.518c-.1 0-.22-.152-.202-.233l-.078.354a513.863 513.863 0 0 0-.832 3.848l-.069.325c-.284 1.349-.51 2.46-.657 3.255-.087.465-.146.818-.177 1.058a2.394 2.394 0 0 0-.026.41c.004.078.004.078.027.21.039.185.039.185.349.563.717.292.656.21.656.21z"></path>
              <path d="M7 10h2v22H7z"></path>
            </g>
          </symbol>
          <symbol style="fill-rule:evenodd;clip-rule:evenodd;fill:#ff6000" viewBox="0 0 34 34" id="recommend">
            <g id="recommend_XMLID_1_">
              <path id="recommend_XMLID_9_"
                    d="M32.5 10.1c-.2-.5-.8-.7-1.3-.5-.5.2-.7.8-.5 1.3.9 1.9 1.3 4 1.3 6.1 0 8.3-6.7 15-15 15S2 25.3 2 17c0-2.7.7-5.2 2-7.4 1.1 0 2-.9 2-2 0-.2 0-.4-.1-.6C8.6 4 12.6 2 17 2c1.9 0 3.7.3 5.4 1 .5.2 1.1-.1 1.3-.6.2-.5-.1-1.1-.6-1.3-2-.7-4-1.1-6.1-1.1-5 0-9.5 2.2-12.6 5.6H4c-1.1 0-2 .9-2 2 0 .4.1.7.3 1C.8 11.1 0 13.9 0 17c0 9.4 7.6 17 17 17s17-7.6 17-17c0-2.4-.5-4.7-1.5-6.9z"
                    class="st0"></path>
              <circle id="recommend_XMLID_10_" cx="27.5" cy="5.8" r="1.5" class="st0"></circle>
              <path id="recommend_XMLID_13_"
                    d="M12 24.3c.4 0 .8-.1 1.2-.3 1.1.6 2.4 1 3.8 1 4.4 0 8-3.6 8-8s-3.6-8-8-8-8 3.6-8 8c0 .9.2 1.9.5 2.7-.3.5-.5 1-.5 1.6 0 1.7 1.3 3 3 3zM17 11c3.3 0 6 2.7 6 6s-2.7 6-6 6c-.8 0-1.6-.2-2.3-.5.2-.4.3-.8.3-1.2 0-1.7-1.3-3-3-3-.3 0-.6.1-.8.1-.1-.4-.2-.9-.2-1.4 0-3.3 2.7-6 6-6z"
                    class="st0"></path>
            </g>
          </symbol>
          <symbol viewBox="0 0 18 18" id="icon_shop">
            <path fill="#888" fill-rule="evenodd"
                  d="M15 6.15a1.745 1.745 0 0 1-1.737 1.601l-.074-.002a1.749 1.749 0 0 1-1.628-1.33.499.499 0 0 0-.488-.406h-.39a.498.498 0 0 0-.49.417 1.744 1.744 0 0 1-1.649 1.32H8.47l-.064-.002a1.057 1.057 0 0 1-.058-.004l-.09-.01A1.748 1.748 0 0 1 6.802 6.41a.499.499 0 0 0-.487-.397h-.39a.497.497 0 0 0-.487.397 1.75 1.75 0 0 1-1.362 1.308L4 7.732a3.84 3.84 0 0 1-.08.01l-.065.005-.06.003-.054.001c-.935 0-1.7-.74-1.741-1.668V2h13v4.15zm-14.998.1L0 6.252a3.314 3.314 0 0 0 3.31 3.318c1.05 0 2.01-.23 2.615-.994.606.765 1.518.994 2.568.994s1.812-.366 2.418-1.131c.606.765 1.716 1.131 2.766 1.131a3.314 3.314 0 0 0 3.309-3.251.49.49 0 0 0 .014-.11V1.435A1.462 1.462 0 0 0 15.571 0H1.417A1.442 1.442 0 0 0 0 1.435v4.816zm14 10.75H2.999A2.004 2.004 0 0 1 1 14.994v-2.979a1 1 0 1 1 2 0v2.979L14.002 15 14 12a1 1 0 1 1 2 0v2.99c0 1.109-.896 2.01-1.998 2.01z"></path>
          </symbol>
        </defs>
      </svg>
      <e-header title="发现"></e-header>
      <section class="parts unmerge">
        <div class="entry list3">
          <a v-for="(item, index) in partList3" :href="item.content_url" class="">
            <img class="icon" :src="item.main_pic_hash | transformImgUrl(1) + '?imageMogr/format/webp/'">
          <p class="title" :style="{'color': item.title_color}">{{ item.title }}</p>
          <p class="tips">{{ item.subtitle }}</p>
            <img style="display: none;">
          </a>
        </div>
        <div class="entry">
          <a v-for="(item, index) in partList" class="sub-pic-hash">
            <img class="icon" :src="item.main_pic_hash | transformImgUrl(1) + '?imageMogr/format/webp/'"
          style="display: none;">
          <p class="title" :style="{'color': item.title_color}" style="display: none;">{{ item.title }}</p>
          <p class="tips" style="display: none;">{{ item.subtitle }}</p>
            <img :src="item.sub_pic_hash | transformImgUrl(1) + '?imageMogr/format/webp/'">
          </a>
        </div>
      </section>
      <section v-if="hotFood.length !== 0">
        <div class="activity-header"><span class="line left"></span><svg class="activity-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#nice"></use></svg>
        美食热推
        <span class="line right"></span></div>
        <p class="activity-sub-title">你的口味，我都懂得</p>
        <div class="activity-body">
          <template v-for="(item, index) in hotFood">
            <a class="discover-food">
              <img :src="item.image_hash | transformImgUrl(1) + '?imageMogr/format/webp/'">
              <div>
                <p class="food-name ui-ellipsis">{{ item.name }}</p>
                <div class="food-info clearfix">
                  <div class="food-price"><span class="price ui-ellipsis"><span><span class="yuan">¥</span>{{ item.price }}</span></span>
                    <del class="original-price ui-ellipsis" style="display: none;">¥</del>
                  </div>
                </div>
              </div>
              <span class="discount" style="display: none;">NaN折</span>
            </a>
          </template>
        </div>
        <p class="activity-more">查看更多
          <svg class="svg-next">
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#tab_found_next_page"></use>
          </svg>
        </p>
      </section>
      <section v-if="day.length !== 0">
        <div class="activity-header"><span class="line left"></span>
          <svg class="activity-icon">
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#tag"></use>
          </svg>
          天天特价
          <span class="line right"></span></div>
        <p class="activity-sub-title">特价商品，一网打尽</p>
        <div class="activity-body">
          <template v-for="(item, index) in day">
            <a class="discover-food">
              <img :src="item.foods[0].image_path | transformImgUrl(1) + '?imageMogr/format/webp/'">
              <div>
                <p class="food-name ui-ellipsis">{{ item.foods[0].name }}</p>
                <div class="food-info clearfix">
                  <div class="food-price"><span class="price ui-ellipsis"><span><span class="yuan">¥</span>{{ item.foods[0].price }}</span></span>
                    <del class="original-price ui-ellipsis">¥{{ item.foods[0].original_price }}</del>
                  </div>
                </div>
              </div>
              <span class="discount">{{ item.foods[0].discount_rate * 10 }}折</span>
            </a>
          </template>
        </div>
        <p class="activity-more">查看更多
          <svg class="svg-next">
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#tab_found_next_page"></use>
          </svg>
        </p>
      </section>
      <section v-if="allEat">
        <div class="activity-header"><span class="line left"></span>
          <svg class="activity-icon">
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#recommend"></use>
          </svg>
          大家都在吃
          <span class="line right"></span></div>
        <p class="activity-sub-title">总有美味在身边</p><!---->
        <div class="order-item">
          <div class="order-owner">
            <img v-if="allEat.avatar !== ''" :src="allEat.avatar | transformImgUrl(1)">
            <img v-else src="../../assets/avatar.png">
          </div>
          <div class="order-detail">
            <div class="owner-name"><span class="name">{{ allEat.nickname }}</span></div>
            <div class="rating">{{ allEat.ordered_day }}天前吃过
            </div>
            <div v-if="allEat.rating_text" :class="{'overflow': ratingEllipsis}" class="comment">
              <p>{{ allEat.rating_text.substring(0, 49) }}<span v-if="ratingEllipsis && allEat.rating_text.length > 49"
              class="ellipsis">...</span><span v-if="!ratingEllipsis && allEat.rating_text.length > 49" class="sub-text">{{ allEat.rating_text.substring(49) }}</span>
              </p>
              <span v-if="ratingEllipsis != null" @click="ratingEllipsis = !ratingEllipsis" class="unfold">{{ ratingEllipsis ? '展开' : '收起'}}</span>
            </div>
            <div class="foods">
              <p class="restaurant"><span class="restaurant-name"><svg class="shop-icon"><use
                xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon_shop"></use></svg>{{ allEat.restaurant_name }}</span><span
                class="restaurant-data"><span>评价{{ allEat.restaurant_rating_score }}分/</span>月售{{ allEat.restaurant_month_sale }}单</span>
              </p>
              <template v-if="allEat.foods" v-for="(item, index) in allEat.foods">
                <a class="food"><span class="food-amount">{{ item.amount }}份</span>
                  <p class="food-name">{{ item.food_name }}</p><img
                    :src="item.image_hash | transformImgUrl(1) + '?imageMogr/format/webp/'">
                </a>
              </template>
            </div>
            <div class="order-footer"><p class="price">
              实付<span class="amount">¥{{ allEat.total_fee }}</span></p><a class="buy">跟一单</a>
            </div>
          </div>
        </div>
        <p class="activity-more">查看更多
          <svg class="svg-next">
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#tab_found_next_page"></use>
          </svg>
        </p>
      </section>
      <section v-if="suggest.length !== 0">
        <div class="activity-header"><span class="line left"></span>
          <svg class="activity-icon">
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#alarm"></use>
          </svg>
          限时好礼
          <span class="line right"></span></div>
        <p class="activity-sub-title">小积分换豪礼</p>
        <div class="activity-body">
          <a v-for="(item, index) in suggest" class="discover-food">
            <img :src="item.image_hash | transformImgUrl(1) + '?imageMogr/format/webp/'">
          <div>
            <p class="food-name ui-ellipsis">{{ item.title }}</p>
            <div class="food-info clearfix">
              <div class="food-price">
                <span class="price ui-ellipsis"><span>{{ item.points_required }}积分</span><!----></span>
                <del class="original-price ui-ellipsis">¥{{ item.original_price }}</del>
              </div>
            </div>
          </div>
          <span class="discount">{{ item.corner_marker }}</span>
          </a>
        </div>
        <p class="activity-more">查看更多
          <svg class="svg-next">
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#tab_found_next_page"></use>
          </svg>
        </p>
      </section>
      <footer-tab></footer-tab>
    </div>
</template>
<style scoped>
  .discover {
    padding-bottom: .013333rem;
  }
  .ui-ellipsis {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  img {
    max-width: 100%;
  }

  /*  第一个板块-start  */
  section {
    margin-bottom: .28rem;
    background: #fff;
    border-top: 1px solid #eee;
    border-bottom: .013333rem solid #eee;
  }
  section.parts {
    border-bottom: none;
    background: transparent none repeat 0 0/auto auto padding-box border-box scroll;
    background: initial;
  }
  .entry {
    border-width: 1px 0;
    box-sizing: border-box;
    overflow: hidden;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background: #fff;
    -webkit-flex-wrap: wrap;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
  }
  .entry:first-child {
    border-top: 0;
  }
  .entry.list3 {
    position: relative;
  }
  .unmerge>.entry:first-child {
    margin-bottom: .28rem;
  }
  .unmerge>.entry:last-child {
    border-top: 1px solid #ededed;
  }
  .entry a {
    box-sizing: border-box;
    padding: .64rem .4rem;
    height: 2.306667rem;
    width: 100%;
    display: block;
    border-bottom: 1px solid #ededed;
  }
  .entry .sub-pic-hash {
    padding: 0;
  }
  .entry.list3 a {
    width: 50%;
  }
  .entry.list2 a:first-child, .entry.list3 a:first-child {
    border-right: 1px solid #ededed;
  }
  .entry.list3 a:nth-child(3n+1) {
    border-right: 1px solid #ededed;
  }
  .entry.list3 a:first-child {
    position: absolute;
    height: 4.613333rem;
    padding: .4rem;
    padding-top: .64rem;
  }
  .entry.list3 a:nth-child(2), .entry.list3 a:nth-child(3) {
    margin-left: 50%;
  }
  .entry .icon {
    float: right;
    width: 1.6rem;
    margin-top: -3%;
  }
  .entry.list3 .icon {
    width: 1.2rem;
  }
  .entry.list3 a:first-child .icon {
    width: 2rem;
    margin: .56rem .693333rem 0;
    position: absolute;
    bottom: .64rem;
  }
  .entry .title {
    line-height: 1.2;
    font-size: .48rem;
    margin-bottom: .16rem;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  .entry .tips {
    line-height: 1.2;
    font-size: .32rem;
    color: #999;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  .entry .sub-pic-hash img {
    width: 100%;
  }
  /*  第一个板块-end  */

  /*  其他板块  */
  .activity-header {
    padding-top: .52rem;
    text-align: center;
    font-size: .48rem;
    font-weight: 700;
    color: #333;
  }
  .line {
    display: inline-block;
    margin: .213333rem .093333rem .173333rem;
    border: 1px solid #333;
    width: .4rem;
    height: 0;
    position: relative;
  }
  .line:after {
    position: absolute;
    top: -.066667rem;
    content: "";
    background: #333;
    height: .133333rem;
    width: .133333rem;
    border-radius: 50%;
  }
  .line.left:after {
    right: -.066667rem;
  }
  .line.right:after {
    left: -.066667rem;
  }
  .activity-icon {
    position: relative;
    top: .053333rem;
    width: .44rem;
    height: .44rem;
  }
  .activity-sub-title {
    font-size: .293333rem;
    color: #999;
    text-align: center;
    padding-bottom: .213333rem;
  }
  .activity-body {
    padding: .32rem 0 .4rem .4rem;
    white-space: nowrap;
  }
  .discover-food {
    display: inline-block;
    position: relative;
    box-sizing: border-box;
    width: 2.96rem;
    margin-right: .16rem;
  }
  .discover-food img {
    width: 4.32rem;
    height: 2.933333rem;
    margin-bottom: .253333rem;
  }
  .discover-food .food-name {
    font-size: .346667rem;
    color: #333;
    margin-bottom: .133333rem;
  }
  .discover-food .food-price {
    height: .64rem;
    line-height: .64rem;
  }
  .discover-food .price {
    font-size: .346667rem;
    height: .48rem;
    line-height: .48rem;
    color: #ff6000;
    margin-right: .093333rem;
    max-width: 1.333333rem;
    display: inline-block;
    vertical-align: middle;
  }
  .discover-food .price .yuan {
    font-size: .293333rem;
  }
  .discover-food .original-price {
    font-size: .293333rem;
    color: #aaa;
    max-width: 1.066667rem;
    display: inline-block;
    vertical-align: middle;
  }
  .discover-food .discount {
    position: absolute;
    top: 0;
    left: 0;
    font-size: .293333rem;
    color: #fff;
    background: #413d3c;
    padding: .066667rem;
  }
  .activity-more, .gift-list-more {
    font-size: .346667rem;
    color: #999;
    text-align: center;
    padding: .4rem 0 .48rem;
  }
  .activity-more {
    padding-top: 0;
  }
  .svg-next {
    height: .24rem;
    width: .133333rem;
    margin-left: .146667rem;
  }

  .order-item {
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background: #fff;
    padding: .4rem;
  }
  .order-owner {
    margin-right: .2rem;
    padding-top: .026667rem;
  }
  .order-owner img {
    width: .8rem;
    border-radius: 50%;
  }
  .order-detail {
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    -ms-flex: 1;
    flex: 1;
    display: block;
    width: 0;
  }
  .owner-name {
    font-size: 0;
    color: #666;
    margin-bottom: .08rem;
    padding-left: .266667rem;
  }
  .owner-name .name {
    font-size: .293333rem;
    font-weight: 700;
  }
  .rating {
    font-size: .293333rem;
    color: #999;
    padding: 0 .266667rem;
  }
  .comment {
    font-size: .32rem;
    color: #666;
    padding: 0 .266667rem;
    margin-top: .213333rem;
    margin-bottom: .32rem;
    word-break: break-all;
  }
  .comment .ellipsis {
    display: none;
  }
  .comment.overflow .ellipsis {
    display: inline;
    display: initial;
  }
  .comment.overflow .sub-text {
    display: none;
  }
  .comment .unfold {
    color: #3190e8;
    cursor: pointer;
    margin-top: .066667rem;
    display: inline-block;
  }
  .comment.overflow .unfold {
    display: inline-block;
  }
  .foods {
    border-bottom: .026667rem solid #eee;
    padding: .266667rem .133333rem 0 .266667rem;
    background: #f9f9f9;
  }
  .foods .restaurant {
    font-size: .266667rem;
    color: #999;
    margin-bottom: .266667rem;
  }
  .foods .restaurant .restaurant-name {
    font-weight: 700;
    color: #888;
  }
  .foods .restaurant .shop-icon {
    position: relative;
    top: .026667rem;
    margin-right: .08rem;
    width: .226667rem;
    height: .226667rem;
  }
  .foods .restaurant .restaurant-data {
    float: right;
  }
  .foods .food {
    display: inline-block;
    position: relative;
    margin-right: .133333rem;
    margin-bottom: .266667rem;
    width: 2.466667rem;
    height: 2.466667rem;
    min-width: 31%;
  }
  .foods .food .food-amount {
    position: absolute;
    right: 0;
    top: 0;
    background: rgba(0,0,0,.7);
    font-size: .24rem;
    font-weight: 700;
    color: #fff;
    padding: 0 .053333rem;
    border-bottom-left-radius: .08rem;
  }
  .foods .food .food-name {
    position: absolute;
    width: 100%;
    bottom: 0;
    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAABaCAYAAACSa4e+AAAAAXNSR…djcT/a8w/5zyKz7tjlXuHBSoVHmestU+m0cQCXV0Murz+WU14hDV2l3wAAAABJRU5ErkJggg==);
    background-repeat: no-repeat;
    background-size: 100% 100%;
    font-size: .293333rem;
    font-weight: 700;
    color: #fff;
    padding: .56rem .12rem .133333rem;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  .foods .food img {
    width: 100%;
    height: 100%;
    max-height: 2.48rem;
    margin: 0;
  }
  .order-footer {
    position: relative;
    padding: .266667rem;
    background: #fcfcfc;
    min-height: 1.333333rem;
  }
  .price {
    background: #fcfcfc;
    font-size: .32rem;
    font-weight: 700;
    color: #666;
    margin-top: .133333rem;
  }
  .price .amount {
    position: relative;
    top: .026667rem;
    font-size: .426667rem;
    color: #ff6000;
    margin: 0 .133333rem;
  }
  .buy {
    display: block;
    position: absolute;
    right: .333333rem;
    top: .266667rem;
    padding: .133333rem .533333rem;
    border: 1px solid #3190e8;
    border-radius: .053333rem;
    font-size: .346667rem;
    color: #3190e8;
  }
</style>
<script>
  import EHeader from '../common/EHeader.vue'
  import FooterTab from '../common/FooterTab.vue'

  export default{
    data () {
      return {
        partList3: [], // 头部数据
        partList: [], // 头部数据
        hotFood: [], // 美食热推
        day: [], // 天天特价
        allEat: null, // 大家都在吃
        ratingEllipsis: null, // 默认显示全部评论
        suggest: [] // 底部限时好礼
      }
    },
    computed: {
      latitude(){ //  纬度
        return this.$store.state.location.latitude
      },
      longitude(){ // 经度
        return this.$store.state.location.longitude
      }
    },
    methods: {
      loadPartData () {
        this.$http({url: 'eleme_api.php', params: {action: 'discover_first', latitude: this.latitude, longitude: this.longitude}}).then(function (res) {
          this.partList3 = res.data[1]
          this.partList = res.data[2]
        })
      },
      loadHotFood () {
        this.$http({url: 'eleme_api.php', params: {action: 'discover_hotfood', latitude: this.latitude, longitude: this.longitude, offset: 0, limit: 3}}).then(function (res) {
          // 取3家店铺的第一种食物
          var foods = []
          for (var i =0; i < res.data.length; i++) {
            foods.push(res.data[i].foods[0])
          }
          this.hotFood = foods
        })
      },
      loadDay () { // 天天特价
        this.$http({url: 'eleme_api.php', params: {action: 'discover_day', latitude: this.latitude, longitude: this.longitude}}).then(function (res) {
          this.day = res.data.query_list.slice(0, 3)
        })
      },
      loadAlleat () { // 大家都在吃
        this.$http({url: 'eleme_api.php', params: {action: 'discover_alleat', latitude: this.latitude, longitude: this.longitude, offset: 0, limit: 1}}).then(function (res) {
          this.allEat = res.data[0]
          if (res.data.length > 0 && this.allEat.rating_text.length > 49) this.ratingEllipsis = true
        })
      },
      loadSuggest () {
        this.$http({url: 'eleme_api.php', params: {action: 'discover_foot'}}).then(function (res) {
          this.suggest = res.data
        })
      }
    },
    created () {
      this.loadPartData()
      this.loadHotFood()
      this.loadDay()
      this.loadAlleat()
      this.loadSuggest()
    },
    components: {
      EHeader, FooterTab
    }
  }
</script>
